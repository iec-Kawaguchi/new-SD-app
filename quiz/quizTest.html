<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>æ„æ€æ±ºå®šã‚¿ã‚¤ãƒ—è¨ºæ–­ï¼ˆé †ä½åŠ ç‚¹ï¼‹ä¸¦ã³é †ã‚¿ã‚¤ãƒ—ï¼ãƒªãƒƒãƒå‡ºåŠ›ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: "æ¸¸ã‚´ã‚·ãƒƒã‚¯ä½“","Yu Gothic","æ¸¸ã‚´ã‚·ãƒƒã‚¯",YuGothic,sans-serif; background: radial-gradient(1200px 600px at 20% -10%, #e0e7ff, transparent), radial-gradient(1000px 500px at 100% 0%, #fde2e4, transparent), linear-gradient(135deg,#f8fafc,#fff); min-height: 100vh; }
    .fade-in { animation: fadeIn .45s ease; }
    @keyframes fadeIn { from {opacity:0; transform: translateY(8px);} to {opacity:1; transform: translateY(0);} }
    .dragging { opacity: .6; }
    .chip { display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .6rem; border-radius:.75rem; background:#EEF2FF; color:#3730A3; font-weight:700; font-size:.85rem; }
    .badge { display:inline-block; padding:.2rem .5rem; border-radius:.5rem; background:#F1F5F9; color:#0F172A; font-weight:600; font-size:.75rem; border:1px solid #E2E8F0; }
    .card { background: linear-gradient(180deg, #ffffffcc, #ffffffdd); border:1px solid #e5e7eb; border-radius:1rem; box-shadow: 0 10px 30px rgba(2,6,23,.08); }
    .soft { background: linear-gradient(180deg, #f8fafc, #ffffff); border:1px solid #e5e7eb; border-radius:1rem; }
    .bar { height: .75rem; border-radius: 999px; background: #e5e7eb; overflow: hidden; }
    .bar>span { display:block; height:100%; width:0%; border-radius:999px; background: linear-gradient(90deg,#6366f1,#ec4899); transition: width 900ms cubic-bezier(.2,.6,.2,1); }
    .pill { display:inline-flex; align-items:center; gap:.35rem; padding:.35rem .6rem; border-radius:999px; font-weight:600; font-size:.75rem; border:1px solid #e5e7eb; background:#fff; }
    .sparkle { position: absolute; inset: 0; pointer-events:none; }
    .sparkle svg { position:absolute; animation: float 6s linear infinite; opacity:.6 }
    @keyframes float {
      from { transform: translateY(0) rotate(0deg); }
      to { transform: translateY(40px) rotate(360deg); }
    }
    .btn { padding:.65rem 1rem; border-radius:.75rem; font-weight:700; color:#fff; background:#4f46e5; }
    .btn:hover { background:#4338ca; }
    .btn-ghost { padding:.6rem 1rem; border-radius:.75rem; font-weight:700; border:1px solid #e5e7eb; background:#fff; }
    .btn-ghost:hover { background:#f8fafc; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; font-size:.7rem; background:#f1f5f9; padding:.15rem .4rem; border-radius:.4rem; border:1px solid #e2e8f0; }
    .qs { background: linear-gradient(180deg,#ffffffbb,#ffffffee); }
    .divider { height:1px; background:linear-gradient(90deg, transparent, #e5e7eb, transparent); }
  </style>
</head>
<body class="relative flex items-center justify-center p-6">

  <!-- è»½ã„ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ« -->
  <div class="sparkle">
    <svg width="14" height="14" style="left:10%; top:6%"><polygon points="7,0 9,6 14,7 9,8 7,14 5,8 0,7 5,6" fill="#a5b4fc"/></svg>
    <svg width="12" height="12" style="left:85%; top:10%"><circle cx="6" cy="6" r="6" fill="#fecdd3"/></svg>
    <svg width="10" height="10" style="left:70%; top:22%"><rect width="10" height="10" fill="#e9d5ff" rx="2"/></svg>
  </div>

  <div class="w-full max-w-5xl card p-6 sm:p-8 fade-in">
    <h1 class="text-2xl sm:text-3xl font-extrabold text-center text-gray-800 tracking-tight">æ„æ€æ±ºå®šã‚¿ã‚¤ãƒ—è¨ºæ–­</h1>
    <p class="text-center text-gray-600 mt-2">å„è¨­å•ã§ <b>4ã¤ã®é¸æŠè‚¢ã«é †ä½ã‚’ã¤ã‘ã¦ãã ã•ã„</b>

    <!-- é€²æ— -->
    <div id="progress" class="hidden mt-6">
      <div class="w-full bg-gray-200 rounded-full h-3">
        <div id="bar" class="h-3 bg-indigo-500 rounded-full transition-all duration-300"></div>
      </div>
      <p id="count" class="text-sm text-gray-600 mt-2 text-center"></p>
    </div>

    <!-- è³ªå• -->
    <div id="qwrap" class="mt-6 space-y-6"></div>

    <!-- çµæœ -->
    <div id="result" class="hidden fade-in">
      <div class="soft p-5 sm:p-6">
        <div class="flex flex-col items-center text-center">
          <h2 id="result-title" class="text-xl sm:text-2xl font-extrabold text-gray-800"></h2>
          <p id="result-lead" class="text-gray-700 mt-2 max-w-2xl"></p>
          <div id="order-code" class="mt-3 text-sm text-gray-600"></div>
          <div class="mt-3 flex flex-wrap gap-2 justify-center" id="order-pills"></div>
        </div>

        <div class="grid gap-5 sm:grid-cols-2 mt-6">
          <div class="card p-4">
            <h3 class="font-bold text-gray-800 mb-3">ã‚¹ã‚³ã‚¢ã¨ãƒ¡ãƒ¼ã‚¿ãƒ¼</h3>
            <div class="space-y-3" id="score-bars"></div>
            <div class="divider my-4"></div>
            <ul id="score-list" class="text-gray-700 space-y-1 text-sm"></ul>
          </div>

          <div class="card p-4">
            <h3 class="font-bold text-gray-800 mb-2">ã‚¿ã‚¤ãƒ—è§£èª¬</h3>
            <p id="type-desc" class="text-gray-700"></p>
            <ul id="type-bullets" class="list-disc list-inside text-gray-700 mt-2 space-y-1"></ul>
            <div id="modifiers" class="mt-3 flex flex-wrap gap-2"></div>
          </div>
        </div>

        <div class="grid gap-5 sm:grid-cols-3 mt-6">
          <div class="card p-4">
            <h4 class="font-semibold text-gray-800 mb-2">ğŸ§­ å¼·ã¿</h4>
            <ul id="strengths" class="list-disc list-inside text-gray-700 space-y-1"></ul>
          </div>
          <div class="card p-4">
            <h4 class="font-semibold text-gray-800 mb-2">âš ï¸ æ³¨æ„ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul id="risks" class="list-disc list-inside text-gray-700 space-y-1"></ul>
          </div>
          <div class="card p-4">
            <h4 class="font-semibold text-gray-800 mb-2">ğŸ’¡ æ´»ã‹ã—æ–¹</h4>
            <ul id="plays" class="list-disc list-inside text-gray-700 space-y-1"></ul>
          </div>
        </div>

        <div class="grid gap-5 sm:grid-cols-2 mt-6">
          <div class="card p-4">
            <h4 class="font-semibold text-gray-800 mb-2">ğŸ¤ ã‚³ãƒ©ãƒœè¡“</h4>
            <ul id="collab" class="list-disc list-inside text-gray-700 space-y-1"></ul>
          </div>
          <div class="card p-4">
            <h4 class="font-semibold text-gray-800 mb-2">ğŸ—£ï¸ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ„</h4>
            <ul id="comm" class="list-disc list-inside text-gray-700 space-y-1"></ul>
          </div>
        </div>

        <div class="soft p-4 mt-6">
          <p id="today" class="text-gray-800 font-semibold mb-1">ğŸŒŸ ä»Šæ—¥ã®ã²ã¨ã“ã¨</p>
          <p id="week" class="text-gray-700">ğŸ“… æ¥é€±ã‚„ã‚‹1ã¤ï¼š</p>
        </div>

        <div class="mt-6 flex flex-wrap gap-3 justify-center">
          <button id="shareX" class="btn">Xï¼ˆTwitterï¼‰ã§ã‚·ã‚§ã‚¢</button>
          <button id="copy" class="btn-ghost">è¦ç´„ã‚’ã‚³ãƒ”ãƒ¼</button>
          <button id="print" class="btn-ghost">å°åˆ· / PDFä¿å­˜ <span class="kbd">Ctrl/Cmd+P</span></button>
          <button id="retry" class="btn-ghost">ã‚„ã‚Šç›´ã™</button>
        </div>
      </div>
    </div>

    <!-- é–‹å§‹ -->
    <div id="start" class="mt-8 text-center">
      <div class="qs p-5 rounded-xl border border-gray-200">
        <p class="text-gray-700">æ‰€è¦æ™‚é–“ã®ç›®å®‰ï¼š<b>3ã€œ5åˆ†</b></p>
        <p class="text-sm text-gray-500 mt-1">ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã¹æ›¿ãˆã‚‹ã ã‘ã€‚è¿·ã£ãŸã‚‰â€œã„ã¾ã®æ°—åˆ†â€ã§OKã€‚</p>
      </div>
      <button id="begin" class="mt-4 btn">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button>
    </div>
  </div>

  <script>
    // === ãƒ™ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ— ===
    const TYPE_META = {
      A: { name: "Aï¼šæ¨é€²ã‚¿ã‚¤ãƒ—", short: "æ¨é€²", desc: "ã‚¹ãƒ”ãƒ¼ãƒ‰ã¨å®Ÿè¡Œã§çµæœã‚’å‡ºã™æ¨é€²å½¹ã€‚ç¾å®Ÿå¿—å‘ãƒ»æ±ºæ–­åŠ›ãŒå¼·ã¿ã€‚" },
      B: { name: "Bï¼šåˆ†æã‚¿ã‚¤ãƒ—", short: "åˆ†æ", desc: "ãƒ‡ãƒ¼ã‚¿ã¨æ§‹é€ ã§æœ€é©è§£ã‚’å°ãåˆ†æå½¹ã€‚æ­£ç¢ºæ€§ãƒ»å†ç¾æ€§ãŒå¼·ã¿ã€‚" },
      C: { name: "Cï¼šå‰µé€ ã‚¿ã‚¤ãƒ—", short: "å‰µé€ ", desc: "æ–°ã—ã„ç™ºæƒ³ã¨å¤šæ§˜æ€§ã§çªç ´ã™ã‚‹å‰µé€ å½¹ã€‚æŸ”è»Ÿæ€§ãƒ»ç€æƒ³åŠ›ãŒå¼·ã¿ã€‚" },
      D: { name: "Dï¼šèª¿å’Œã‚¿ã‚¤ãƒ—", short: "èª¿å’Œ", desc: "å®‰å¿ƒæ„Ÿã¨åˆæ„å½¢æˆã§çµ„ç¹”ã‚’é€²ã‚ã‚‹èª¿æ•´å½¹ã€‚ä¿¡é ¼ãƒ»å®‰å®šãŒå¼·ã¿ã€‚" }
    };

    // === ä¸Šä½2ã¤ã®é †åºãƒšã‚¢ï¼ˆ12é€šã‚Šï¼‰ ===
    const PAIR_MAP = {
      "AB": { title:"ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ»ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ã‚¹ãƒˆ", lead:"æ¨é€²Ã—åˆ†æã€‚ç´ æ—©ãå‹•ãã¤ã¤ç­‹é“ã‚’ç«‹ã¦ã€æˆ¦ç•¥ã‚’å®Ÿè¡Œã«è½ã¨ã™ã€‚", bullets:["åˆå‹•ãŒé€Ÿãå®Ÿè£…ã¾ã§å°ã‘ã‚‹","æ•°å­—ãƒ»æ ¹æ‹ ã«å¼·ã„","çŸ­æœŸã¨ä¸­é•·æœŸã®æ©‹æ¸¡ã—ãŒå¾—æ„"] },
      "AC": { title:"ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼", lead:"æ¨é€²Ã—å‰µé€ ã€‚æ–°ã—ã„ç™ºæƒ³ã‚’ç´ æ—©ãå½¢ã«ã—ã€æµã‚Œã‚’ä½œã‚‹ã€‚", bullets:["ç™½åœ°ã‹ã‚‰ã®ç«‹ã¡ä¸Šã’ã«å¼·ã„","è©¦ä½œâ†’å­¦ç¿’ã®ãƒ«ãƒ¼ãƒ—ãŒé€Ÿã„","å‘¨å›²ã‚’å·»ãè¾¼ã¿ç‰½å¼•"] },
      "AD": { title:"ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼", lead:"æ¨é€²Ã—èª¿å’Œã€‚åˆæ„ã‚’å–ã‚ŠãªãŒã‚‰å‰ã«é€²ã‚ã‚‹ã€‚", bullets:["é–¢ä¿‚è€…èª¿æ•´ã¨å®Ÿè¡ŒãŒä¸¡ç«‹","æ‘©æ“¦ã®ç†±ã‚’æ¨é€²åŠ›ã«å¤‰ãˆã‚‹","ç¾å ´ã‚’è¦‹ãªãŒã‚‰é€Ÿåº¦ç¶­æŒ"] },
      "BA": { title:"å®Ÿè£…æˆ¦ç•¥å®¶", lead:"åˆ†æÃ—æ¨é€²ã€‚ãƒ­ã‚¸ãƒƒã‚¯ã§é“ç­‹ã‚’æãã€ç¢ºåº¦é«˜ãå‰é€²ã•ã›ã‚‹ã€‚", bullets:["è¦ä»¶å®šç¾©â†’å®Ÿè£…ã®ç²¾åº¦ãŒé«˜ã„","ãƒªã‚¹ã‚¯æœ€å°åŒ–ãŒå¾—æ„","KPIè¨­è¨ˆã«å¼·ã„"] },
      "BC": { title:"è¨­è¨ˆã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼", lead:"åˆ†æÃ—å‰µé€ ã€‚ä»®èª¬ã‚’æ§‹é€ åŒ–ã—ã€æ¤œè¨¼å¯èƒ½ãªå½¢ã«è½ã¨ã™ã€‚", bullets:["ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ä»•æ§˜åŒ–ã§ãã‚‹","å†ç¾æ€§ã®ã‚ã‚‹æ¤œè¨¼è¨­è¨ˆ","ç™ºæ•£ã¨åæŸã®åˆ‡æ›¿ãŒå·§ã¿"] },
      "BD": { title:"åˆæ„è¨­è¨ˆå£«", lead:"åˆ†æÃ—èª¿å’Œã€‚é–¢ä¿‚è€…ã®ç´å¾—ã¨æœ€é©è§£ã®ä¸¡ç«‹ã‚’å›³ã‚‹ã€‚", bullets:["æ„æ€æ±ºå®šã®é€æ˜æ€§ã‚’ä½œã‚‹","åˆ©å®³èª¿æ•´ã¨æ ¹æ‹ æç¤º","å“è³ªä¿è¨¼ã«å¼·ã„"] },
      "CA": { title:"ã‚¢ã‚¤ãƒ‡ã‚¢ãƒ‰ãƒ©ã‚¤ãƒãƒ¼", lead:"å‰µé€ Ã—æ¨é€²ã€‚ç™ºæƒ³ã‚’åŸå‹•åŠ›ã«ã—ã¦çªç ´ã™ã‚‹ã€‚", bullets:["æœªçŸ¥ãƒ†ãƒ¼ãƒã®æ‰“é–‹","ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—é§†å‹•","æ–°è¦ä¾¡å€¤ã®ç™ºè¦‹"] },
      "CB": { title:"ä»®èª¬è¨­è¨ˆè€…", lead:"å‰µé€ Ã—åˆ†æã€‚ã²ã‚‰ã‚ãã‚’æ¤œè¨¼å¯èƒ½ãªä»®èª¬ã«è½ã¨ã—è¾¼ã‚€ã€‚", bullets:["é£›ã³çŸ³ã‚’æ©‹ã«å¤‰ãˆã‚‹","è¤‡æ•°æ¡ˆã®è©•ä¾¡ãŒé€Ÿã„","å­¦ç¿’ã‚µã‚¤ã‚¯ãƒ«è¨­è¨ˆãŒå¾—æ„"] },
      "CD": { title:"å…±å‰µãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼", lead:"å‰µé€ Ã—èª¿å’Œã€‚å¤šæ§˜ãªè¦–ç‚¹ã‚’æŸã­ã¦ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç£¨ãã€‚", bullets:["å ´ã¥ãã‚ŠãŒä¸Šæ‰‹ã„","ç•°è³ªãªæ„è¦‹ã‚’ä¾¡å€¤åŒ–","å‚åŠ è€…ã®ç´å¾—æ„Ÿã‚’æ‹…ä¿"] },
      "DA": { title:"å”åƒæ¨é€²è€…", lead:"èª¿å’ŒÃ—æ¨é€²ã€‚é–¢ä¿‚è€…ã‚’æ•´ãˆãªãŒã‚‰å‰é€²ã•ã›ã‚‹ã€‚", bullets:["å·»ãè¾¼ã¿ã¨å®Ÿè£…ã®ä¸¡ç«‹","æ‘©æ“¦ã‚’æœ€å°åŒ–","ç¾å ´ã®å®‰å¿ƒæ„Ÿã‚’ç¶­æŒ"] },
      "DB": { title:"åˆæ„ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ã‚¹ãƒˆ", lead:"èª¿å’ŒÃ—åˆ†æã€‚åˆæ„å½¢æˆã‚’ãƒ­ã‚¸ã‚«ãƒ«ã«æ”¯ãˆã‚‹ã€‚", bullets:["æ ¹æ‹ ãƒ™ãƒ¼ã‚¹ã®èª¿æ•´","åå¯¾æ„è¦‹ã®å¸åãŒå·§ã¿","èª¬æ˜è²¬ä»»ã‚’æœãŸã™"] },
      "DC": { title:"ãƒ•ã‚¡ã‚·ãƒªã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼", lead:"èª¿å’ŒÃ—å‰µé€ ã€‚å®‰å…¨ãªå ´ã§æ–°ã—ã„ç™ºæƒ³ã‚’å¼•ãå‡ºã™ã€‚", bullets:["å®‰å¿ƒÃ—æŒ‘æˆ¦ã®ä¸¡ç«‹","ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—è¨­è¨ˆ","å¤šæ§˜æ€§ã‚’åŠ›ã«å¤‰ãˆã‚‹"] },
    };

    // === è³ªå• ===ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æä¾›ãã®ã¾ã¾ï¼‰
    const QUESTIONS = [
      { text: "åƒãã“ã¨ã«ã‚ˆã£ã¦ä½•ã‚’å¾—ãŸã„ã‹ï¼Ÿ", options: ["æ˜‡é€²ã‚„åœ°ä½","å¾—æ„é ˜åŸŸã§ä¸€ç•ªã«ãªã‚‹ã“ã¨","è‡ªèº«ã®ä»•äº‹ã«å¯¾ã™ã‚‹è©•ä¾¡","è·ã‚„åå…¥ã®å®‰å®š"] },
      { text: "ã‚ãªãŸã«ã¨ã£ã¦å¥½ã¾ã—ã„ä»•äº‹ã¨ã¯ï¼Ÿ", options: ["æŠ€è¡“çš„ã§æ˜ç¢ºãªä»•äº‹","å¤šæ§˜æ€§ã®ã‚ã‚‹ä»•äº‹","è‡ªä¸»æ€§ã®ã‚ã‚‹ä»•äº‹","äººã‚’å·»ãè¾¼ã‚“ã§ãŠã“ãªã†ä»•äº‹"] },
      { text: "éƒ¨ä¸‹ã‚’æŒã£ãŸã¨ãã«éƒ¨ä¸‹ã«æœŸå¾…ã™ã‚‹ã“ã¨ã¯ï¼Ÿ", options: ["ç”Ÿç”£æ€§ã¨ã‚¹ãƒ”ãƒ¼ãƒ‰","èƒ½åŠ›ã®é«˜ã•","çŒ®èº«çš„ã§è¿…é€Ÿãªå¯¾å¿œ","ææ¡ˆã‚’å—å®¹ã—ã¦ãã‚Œã‚‹ã“ã¨"] },
      { text: "åƒãæ™‚ã€ã©ã‚“ãªã“ã¨ã‚’è¿½æ±‚ã—ãŸã„ã‹ï¼Ÿ", options: ["å®Ÿè³ªçš„ãªæˆæœ","ãƒ™ã‚¹ãƒˆãªè§£æ±ºç­–","æ–°ã—ã„æ–¹æ³•ã‚„ã‚¢ã‚¤ãƒ‡ã‚¢","è‰¯å¥½ãªè·å ´ç’°å¢ƒ"] },
      { text: "ä»•äº‹ã§ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å¾—æ„ãªæ–¹æ³•ã¯ï¼Ÿ", options: ["ç›´æ¥å¯¾è©±","æ›¸é¢","ã‚°ãƒ«ãƒ¼ãƒ—è¨è­°","ãƒ•ã‚©ãƒ¼ãƒãƒ«ãªä¼šè­°"] },
      { text: "ä»•äº‹ã®ä½•ã‹ã‚’è¨ˆç”»ã™ã‚‹ã¨ãã«ã©ã‚“ãªã“ã¨ã«ç•™æ„ã™ã‚‹ã‹ï¼Ÿ", options: ["ç¾åœ¨ã®å•é¡Œ","ç›®çš„ã¸ã®åˆè‡´","å°†æ¥ã®ç›®æ¨™","ã‚­ãƒ£ãƒªã‚¢ã®é–‹ç™º"] },
      { text: "å•é¡Œã‚’è§£æ±ºã™ã‚‹ã¨ãã©ã‚“ãªæ‰‹æ³•ã‚’ä½¿ã†ã‹ï¼Ÿ", options: ["ç«‹è¨¼æ¸ˆã¿ã®æ‰‹æ³•","æ…é‡ãªåˆ†æã®é©ç”¨","å‰µé€ çš„ãªæ‰‹æ³•","è‡ªåˆ†ã®æ„Ÿè¦šã‚’å°Šé‡"] },
      { text: "æƒ…å ±ã«é–¢ã—ã¦é‡è¦–ã—ã¦ã„ã‚‹ã“ã¨ã¯ï¼Ÿ", options: ["ç¾åœ¨ã®äº‹å®Ÿã€æ½®æµ","æ­£ç¢ºã§å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿","å¤šãã®äººã®å¤šæ§˜ãªæ„è¦‹","åˆ†ã‹ã‚Šæ˜“ã„ãƒ‡ãƒ¼ã‚¿"] },
      { text: "ç‚ºã™ã¹ãã“ã¨ãŒã¯ã£ãã‚Šã—ãªã„ã¨ãã€ã©ã†ã™ã‚‹ã‹ï¼Ÿ", options: ["ç›´æ„Ÿã«é ¼ã‚‹","äº‹å®Ÿã‚’èª¿ã¹ã‚‹","æŠ˜è¡·æ¡ˆã‚’æ¢ã‚‹","æ±ºæ–­ã§ãã‚‹ã¾ã§å¾…ã¤"] },
      { text: "ã§ãã‚‹ã ã‘é¿ã‘ãŸã„ã“ã¨ã¯ï¼Ÿ", options: ["é•·æ™‚é–“ã®è¨è­°","æœªå®Œæˆã®ä»•äº‹","æ•°å­—ã‚„æ•°å¼ã‚’ä½¿ã†ã“ã¨","ä»–è€…ã¨ã®å¯¾ç«‹"] },
      { text: "ã‚ãªãŸã®å¾—æ„ãªåˆ†é‡ã¯ï¼Ÿ", options: ["æ—¥æ™‚ã‚„äº‹å®Ÿã®è¨˜æ†¶","é›£å•ã®è§£æ±º","å¯èƒ½æ€§ã®è¿½æ±‚","ä»–è€…ã¨ã®äº¤æµ"] },
      { text: "æ™‚é–“ãŒé™ã‚‰ã‚Œã¦ã„ã‚‹ã¨ãã¯ã©ã†ã™ã‚‹ï¼Ÿ", options: ["æ±ºæ–­ã—è¿…é€Ÿã«è¡Œå‹•ã™ã‚‹","è¨ˆç”»ã¨å„ªå…ˆé †ä½ã«å¾“ã†","ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’é¿ã‘ã‚‹","æŒ‡å°ã‚„æ”¯æ´ã‚’æ±‚ã‚ã‚‹"] },
      { text: "ç¤¾äº¤ã®å ´ã§ã¯ï¼Ÿ", options: ["äººã¨è©±ã™","è©±ã•ã‚Œã¦ã„ã‚‹äº‹ã«ã¤ã„ã¦è€ƒãˆã‚‹","çŠ¶æ³ã‚’è¦³å¯Ÿã™ã‚‹","ä¼šè©±ã‚’è´ã"] },
      { text: "ã‚ˆãè¨˜æ†¶ã—ã¦ã„ã‚‹ã“ã¨ã¯ï¼Ÿ", options: ["äººã®åå‰","äººã¨ä¼šã£ãŸå ´æ‰€","äººã®é¡”","äººã®æ€§æ ¼"] },
      { text: "ä»•äº‹ã§å¾—ã‚‰ã‚Œã‚‹ã‚‚ã®ã¯ï¼Ÿ", options: ["äººã«å¯¾ã™ã‚‹å½±éŸ¿åŠ›","æŒ‘æˆ¦çš„ãªèª²é¡Œ","å€‹äººç›®æ¨™ã®é”æˆ","çµ„ç¹”å…¨ä½“ã‹ã‚‰ã®ç´å¾—æ„Ÿ"] },
      { text: "ä¸€ç·’ã«åƒãä¸Šã§å¥½ã¾ã—ã„äººã¯ï¼Ÿ", options: ["ç²¾åŠ›çš„ã§è¦‡æ°—ã®ã‚ã‚‹äºº","è‡ªä¿¡ãŒã‚ã‚‹äºº","ã‚ªãƒ¼ãƒ—ãƒ³ãªæ€§æ ¼ã®äºº","ä¸å¯§ã§çŒœç–‘å¿ƒã®ãªã„äºº"] },
      { text: "ã‚¹ãƒˆãƒ¬ã‚¹ãŒã‚ã‚‹ã¨ãã¯ï¼Ÿ", options: ["ä¸å®‰ã€å¿ƒé…ã«ãªã‚‹","ç›®ã®å‰ã®å•é¡Œã«é›†ä¸­ã™ã‚‹","æŒ«æŠ˜ã—ãã†ã«ãªã‚‹","ç‰©å¿˜ã‚ŒãŒå¤šããªã‚‹"] },
      { text: "äººã¯ã‚ãªãŸã‚’ã©ã†æ€ã£ã¦ã„ã‚‹ã‹ï¼Ÿ", options: ["ã‚¢ã‚°ãƒ¬ãƒƒã‚·ãƒ–","è¦å¾‹æ­£ã—ã„","å‰µé€ åŠ›è±Šã‹","å”åŠ›çš„"] },
      { text: "ã©ã®ã‚ˆã†ã«æ„æ€æ±ºå®šã‚’ã™ã‚‹ï¼Ÿ", options: ["ç¾å®Ÿçš„ã§æŒ‡ç¤ºçš„","ä½“ç³»çš„ã‹æŠ½è±¡çš„","ãŠãŠã‚‰ã‹ã§æŸ”è»Ÿ","ä»–è€…ã®ãƒ‹ãƒ¼ã‚ºã«æ•æ„Ÿ"] },
      { text: "å«Œãªã“ã¨ã¯ï¼Ÿ", options: ["ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’å¤±ã†ã“ã¨","é€€å±ˆãªä»•äº‹","è¦å‰‡ã«å¾“ã†ã“ã¨","æ‹’çµ¶ã•ã‚Œã‚‹ã“ã¨"] },
    ];

    // é †ä½â†’ç‚¹
    const RANK_POINTS = [8,4,2,1];

    // åˆè¨ˆ
    const totals = { A:0, B:0, C:0, D:0 };
    let idx = 0;

    // UIå‚ç…§
    const start = document.getElementById("start");
    const begin = document.getElementById("begin");
    const progress = document.getElementById("progress");
    const bar = document.getElementById("bar");
    const count = document.getElementById("count");
    const qwrap = document.getElementById("qwrap");
    const result = document.getElementById("result");
    const retry = document.getElementById("retry");

    begin.onclick = () => {
      start.classList.add("hidden");
      progress.classList.remove("hidden");
      renderQuestion();
      updateProgress();
    };
    document.getElementById("copy").onclick = copySummary;
    document.getElementById("print").onclick = () => window.print();
    document.getElementById("shareX").onclick = shareX;
    retry.onclick = () => location.reload();

    function updateProgress() {
      const p = Math.round((idx / QUESTIONS.length) * 100);
      bar.style.width = p + "%";
      count.textContent = `${idx}/${QUESTIONS.length} å•å®Œäº†`;
    }

    function renderQuestion() {
      qwrap.innerHTML = "";
      if (idx >= QUESTIONS.length) return showResult();

      const q = QUESTIONS[idx];
      const node = document.createElement("div");
      node.className = "fade-in";

      node.innerHTML = `
        <div class="soft p-5 rounded-xl border border-gray-200">
          <p class="text-lg font-semibold text-center text-gray-800 mb-2">Q${idx+1}. ${q.text}</p>
          <p class="text-sm text-gray-600 mb-3 text-center">ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ <b>ä¸Šã‹ã‚‰ 1ä½â†’4ä½</b> ã«ä¸¦ã¹æ›¿ãˆã€ã€Œã“ã®é †ã§ç¢ºå®šã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>

          <ol id="rank-list" class="space-y-2">
            ${q.options.map((opt, i) => `
              <li class="item p-4 bg-white border border-gray-300 rounded-xl shadow-sm hover:shadow-md transition cursor-move"
                  draggable="true" data-index="${i}">
                <div class="flex items-center gap-3">
                  <span class="handle select-none w-8 h-8 rounded-lg bg-gray-100 border flex items-center justify-center text-sm font-semibold"></span>
                  <span class="font-medium text-gray-800 flex-1">${opt}</span>
                  <span class="rank-hint text-xs text-gray-500">â€”</span>
                </div>
              </li>
            `).join('')}
          </ol>

          <div class="mt-4 flex items-center justify-end text-sm text-gray-600">
            <button id="confirm" class="btn">ã“ã®é †ã§ç¢ºå®š</button>
          </div>
        </div>
      `;
      qwrap.appendChild(node);

      // A/B/C/D ãƒ©ãƒ™ãƒ«
      const labels = ['A','B','C','D'];
      qwrap.querySelectorAll('.handle').forEach((el, i) => el.textContent = labels[i]);

      // ãƒ’ãƒ³ãƒˆæ›´æ–°
      function refreshHints() {
        const lis = Array.from(document.querySelectorAll('#rank-list .item'));
        lis.forEach((li, pos) => {
          const hint = li.querySelector('.rank-hint');
          hint.textContent = `${pos+1}ä½`;
        });
      }

      // DnD
      const list = document.getElementById('rank-list');
      let dragEl = null;
      list.addEventListener('dragstart', (e) => {
        dragEl = e.target.closest('.item');
        if (!dragEl) return;
        dragEl.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
      });
      list.addEventListener('dragend', () => {
        if (dragEl) dragEl.classList.remove('dragging');
        dragEl = null;
        refreshHints();
      });
      list.addEventListener('dragover', (e) => {
        e.preventDefault();
        const afterEl = getDragAfterElement(list, e.clientY);
        const dragging = document.querySelector('.dragging');
        if (!dragging) return;
        if (afterEl == null) list.appendChild(dragging);
        else list.insertBefore(dragging, afterEl);
      });
      function getDragAfterElement(container, y) {
        const els = [...container.querySelectorAll('.item:not(.dragging)')];
        return els.reduce((closest, child) => {
          const box = child.getBoundingClientRect();
          const offset = y - box.top - box.height / 2;
          if (offset < 0 && offset > closest.offset) return { offset, element: child };
          else return closest;
        }, { offset: Number.NEGATIVE_INFINITY }).element;
      }
      refreshHints();

      // ç¢ºå®š
      const confirmBtn = document.getElementById('confirm');
      let locked = false;
      confirmBtn.onclick = () => {
        if (locked) return;
        locked = true;
        const order = [...document.querySelectorAll('#rank-list .item')].map(li => Number(li.getAttribute('data-index')));
        order.forEach((optIndex, pos) => {
          const typeKey = ['A','B','C','D'][optIndex];
          totals[typeKey] += RANK_POINTS[pos];
        });
        idx++;
        updateProgress();
        renderQuestion();
      };
    }

    // ====== çµæœ ======
    function buildOrderCode(entries) {
      const groups = [];
      let i = 0;
      while (i < entries.length) {
        const tieGroup = [entries[i][0]];
        let j = i + 1;
        while (j < entries.length && entries[j][1] === entries[i][1]) { tieGroup.push(entries[j][0]); j++; }
        groups.push(tieGroup);
        i = j;
      }
      return groups.map(g => g.join("=")).join(" > ");
    }

    function showResult() {
      qwrap.classList.add("hidden");
      progress.classList.add("hidden");
      result.classList.remove("hidden");

      const entries = Object.entries(totals).sort((a,b)=>b[1]-a[1]); // é™é †
      const orderCode = buildOrderCode(entries);

      // ä»£è¡¨ï¼ˆã‚¿ã‚¤ãªã‚‰è¾æ›¸é †ï¼‰
      const topCandidates = entries.filter(e => e[1] === entries[0][1]).map(e => e[0]).sort();
      const topKey = topCandidates[0];
      const secondKey = (topCandidates.length === 1) ? entries[1][0]
                         : entries.filter(e => e[1] === entries[0][1]).map(e=>e[0]).sort()[1] || entries[1][0];
      const pairKey = (topKey || "") + (secondKey || "");
      const pair = PAIR_MAP[pairKey];

      const title = pair ? pair.title : TYPE_META[topKey].name;
      const lead  = pair ? pair.lead  : TYPE_META[topKey].desc;
      const bullets = pair ? pair.bullets : ["æ„æ€æ±ºå®šã®æ ¸ãŒæ˜ç¢ºã§ãƒ–ãƒ¬ãªã„","å¾—æ„é ˜åŸŸã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå®‰å®š","å‘¨å›²ã«ä¸ãˆã‚‹å½¹å‰²ãŒã‚ã‹ã‚Šã‚„ã™ã„"];

      document.getElementById("result-title").innerHTML =
        `ã‚ãªãŸã®ã‚¿ã‚¤ãƒ—ï¼š<span class="chip">${TYPE_META[topKey].short}Ã—${TYPE_META[secondKey].short}</span> <span class="text-gray-500 text-base">(${title})</span>`;
      document.getElementById("result-lead").textContent = lead;

      // é †ä½ãƒ”ãƒ«
      const orderPills = document.getElementById("order-pills");
      orderPills.innerHTML = "";
      entries.forEach(([k,v], i) => {
        const span = document.createElement("span");
        span.className = "pill";
        span.textContent = `${i+1}ä½ï¼š${TYPE_META[k].short}ï¼ˆ${v}ï¼‰`;
        orderPills.appendChild(span);
      });

      // æ£’ã‚°ãƒ©ãƒ•
      const bars = document.getElementById("score-bars");
      bars.innerHTML = "";
      const max = Math.max(...Object.values(totals), 1);
      ["A","B","C","D"].forEach(k=>{
        const wrap = document.createElement("div");
        wrap.innerHTML = `
          <div class="flex items-center justify-between mb-1">
            <span class="font-semibold text-gray-800">${k}ï¼š${TYPE_META[k].short}</span>
            <span class="text-sm text-gray-600">${totals[k]}</span>
          </div>
          <div class="bar"><span style="width:0%"></span></div>
        `;
        bars.appendChild(wrap);
        requestAnimationFrame(()=> {
          const span = wrap.querySelector(".bar>span");
          span.style.width = Math.round((totals[k] / max) * 100) + "%";
        });
      });

      // ã‚¹ã‚³ã‚¢è¡¨
      const ul = document.getElementById("score-list");
      ul.innerHTML = "";
      ["A","B","C","D"].forEach(k=>{
        const li = document.createElement("li");
        li.innerHTML = `<span class="inline-block w-6 font-semibold">${k}</span>ï¼š${totals[k]} ç‚¹ï¼ˆ${TYPE_META[k].short}ï¼‰`;
        ul.appendChild(li);
      });

      // è§£èª¬ãƒ»å¼¾
      document.getElementById("type-desc").textContent = "ä¸Šä½2è»¸ã®æ›ã‘åˆã‚ã›ãŒã‚ãªãŸã®æ„æ€æ±ºå®šã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚³ã‚¢ã§ã™ã€‚3ä½ãƒ»4ä½ã¯çŠ¶æ³æ¬¡ç¬¬ã§è¡¨ã«å‡ºã‚‹è£œæ­£è¦ç´ ã«ãªã‚Šã¾ã™ã€‚";
      const bulletsEl = document.getElementById("type-bullets");
      bulletsEl.innerHTML = "";
      bullets.forEach(b=>{ const li=document.createElement("li"); li.textContent=b; bulletsEl.appendChild(li); });

      // ä¿®é£¾å­ï¼ˆ3ä½/4ä½ï¼‰
      const third = entries[2][0], fourth = entries[3][0];
      const modLabels = {A:"æ¨é€²å¯„ã‚Š",B:"åˆ†æå¯„ã‚Š",C:"å‰µé€ å¯„ã‚Š",D:"èª¿å’Œå¯„ã‚Š"};
      const mods = document.getElementById("modifiers");
      mods.innerHTML = "";
      [third, fourth].forEach(k=>{
        const span = document.createElement("span");
        span.className = "badge"; span.textContent = modLabels[k]; mods.appendChild(span);
      });

      // ãƒªãƒƒãƒãªé•·æ–‡ã‚³ãƒ¡ãƒ³ãƒˆç¾¤ï¼ˆã‚¿ã‚¤ãƒ—ã®çµ„åˆã›ã«å¿œã˜ã¦å¾®å¦™ã«å¤‰èª¿ï¼‰
      const flavor = (k1,k2) => {
        const map = {
          "AB":[
            "æ±ºã‚ãŸã‚‰å‹•ãã€ãã®å ´ã§ç­‹é“ã‚’æ•´ãˆã‚‹â€œå‰é€²ã®è¦â€ã€‚",
            "çŸ­ã„ä¼šè©±ã§ã‚‚è«–ç‚¹ã‚’æ´ã¿ã€ã‚¿ã‚¹ã‚¯ã«å¤‰æ›ã™ã‚‹é€Ÿåº¦ãŒå…‰ã‚Šã¾ã™ã€‚"
          ],
          "AC":[
            "ç™½ç´™ã‹ã‚‰å½¢ã‚’ä½œã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã§çœŸä¾¡ã‚’ç™ºæ®ã€‚",
            "è©¦ã—ã¦å­¦ã¶å§¿å‹¢ãŒãƒãƒ¼ãƒ ã®å¥½å¥‡å¿ƒã‚’å¼•ãå‡ºã—ã¾ã™ã€‚"
          ],
          "AD":[
            "åˆ©å®³ã®ç•°ãªã‚‹äººã‚’å‰å‘ãã«æŸã­ã‚‹ãƒ‰ãƒ©ã‚¤ãƒ–æ„Ÿã€‚",
            "é–¢ä¿‚è€…ã®å®‰å¿ƒã¨æˆæœã®ä¸¡è¼ªã‚’å›ã›ã‚‹å¸Œå°‘ã‚¿ã‚¤ãƒ—ã€‚"
          ],
          "BA":[
            "è¨­è¨ˆã‚’ç¾å ´ã§å‹•ãè§£ã«è½ã¨ã™â€œä»•æ§˜â†’å®Ÿè£…â€ã®è·äººã€‚",
            "å“è³ªã¨ã‚¹ãƒ”ãƒ¼ãƒ‰ã®ãƒãƒ©ãƒ³ã‚¹æ„Ÿè¦šãŒæŠœç¾¤ã§ã™ã€‚"
          ],
          "BC":[
            "ã²ã‚‰ã‚ãã‚’â€œæ¤œè¨¼å¯èƒ½ãªæ§‹é€ â€ã«ç¿»è¨³ã§ãã‚‹è¨­è¨ˆè„³ã€‚",
            "æ„æ€æ±ºå®šã®å†ç¾æ€§ã‚’é«˜ã‚ã‚‹ã®ãŒå¾—æ„ã€‚"
          ],
          "BD":[
            "èª¬æ˜è²¬ä»»ã‚’æœãŸã—ã¤ã¤ã€åˆæ„å½¢æˆã‚’å‰ã«é€²ã‚ã‚‹èˆµå–ã‚Šã€‚",
            "â€œç´å¾—ã—ã¦é€²ã‚€â€ç©ºæ°—ã‚’ä½œã‚Œã¾ã™ã€‚"
          ],
          "CA":[
            "ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ¨é€²åŠ›ã«å¤‰ãˆã‚‹èµ·ç‚¹ã®äººã€‚",
            "ã€ã¾ãšè§¦ã£ã¦ã¿ã‚‹ã€ãŒå¤‰åŒ–ã®çªç ´å£ã«ãªã‚Šã¾ã™ã€‚"
          ],
          "CB":[
            "ç™ºæ•£ã—ãŸæ¡ˆã‚’ä»®èª¬ã«æŸã­ã€æ¤œè¨¼ã§ç£¨ãå‰µé€ ã¨æ§‹é€ ã®äºŒåˆ€æµã€‚",
            "ç„¡é§„æ‰“ã¡ã‚’æ¸›ã‚‰ã—ã€å­¦ç¿’é€Ÿåº¦ã‚’ä¸Šã’ã¾ã™ã€‚"
          ],
          "CD":[
            "å¤šæ§˜ãªè¦–ç‚¹ã‚’å°Šé‡ã—ã€å…±å‰µã®å ´ã‚’è¨­è¨ˆã§ãã‚‹äººã€‚",
            "é–¢ä¸è€…ãŒâ€œè‡ªåˆ†ã”ã¨åŒ–â€ã™ã‚‹å ´ä½œã‚ŠãŒä¸Šæ‰‹ã€‚"
          ],
          "DA":[
            "è¡çªã‚’é¿ã‘ã¤ã¤ãƒ‰ãƒ©ã‚¤ãƒ–ã™ã‚‹â€œé™ã‹ãªæ¨é€²å½¹â€ã€‚",
            "å‘¨å›²ã®å¿ƒç†çš„å®‰å…¨æ€§ã‚’ç¢ºä¿ã—ãªãŒã‚‰é€Ÿåº¦ã‚’ä¿ã¦ã¾ã™ã€‚"
          ],
          "DB":[
            "åå¯¾æ„è¦‹ã®ã‚¨ãƒƒã‚»ãƒ³ã‚¹ã‚’å–ã‚Šè¾¼ã¿ã€æ ¹æ‹ ã§æ•´ãˆã‚‹èª¿æ•´è€…ã€‚",
            "è­°è«–ãŒé•·å¼•ãå ´ã‚’â€œæ±ºã‚ã‚‹å ´â€ã«å¤‰ãˆã‚‰ã‚Œã¾ã™ã€‚"
          ],
          "DC":[
            "å®‰å¿ƒã®ä¸­ã«æŒ‘æˆ¦ã‚’ç½®ããƒ•ã‚¡ã‚·ãƒªå‹ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã€‚",
            "äººãŒâ€œå‡ºã—ãŸããªã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢â€ã‚’å¼•ãå‡ºã—ã¾ã™ã€‚"
          ],
        };
        return map[`${k1}${k2}`] || ["å¾—æ„ã¨ã™ã‚‹æ„æ€æ±ºå®šã®ãƒªã‚ºãƒ ãŒæ˜ç¢ºã§ã™ã€‚","çŠ¶æ³ã«å¿œã˜ã¦ã‚®ã‚¢ã‚’å¤‰ãˆã‚‹ã¨ã•ã‚‰ã«å¼·ããªã‚Šã¾ã™ã€‚"];
      };

      const strengths = document.getElementById("strengths");
      const risks = document.getElementById("risks");
      const plays = document.getElementById("plays");
      const collab = document.getElementById("collab");
      const comm = document.getElementById("comm");
      strengths.innerHTML = ""; risks.innerHTML = ""; plays.innerHTML = ""; collab.innerHTML = ""; comm.innerHTML = "";

      [...flavor(topKey, secondKey),
        "åˆ¤æ–­ã®â€œåˆé€Ÿâ€ãŒå®‰å®šã—ã¦ã„ã‚‹",
        "æŠ½è±¡â†’å…·ä½“ã®å¤‰æ›ãŒé€Ÿã„ / ã¾ãŸã¯å …å®Ÿ"].forEach(t=>addLi(strengths,t));

      [
        "å¼·ã¿ãŒå‡ºã™ãã‚‹ã¨ç›²ç‚¹ãŒå›ºå®šåŒ–ã™ã‚‹",
        "çŸ­çµ¡çš„ãªYes/Noã€éåº¦ãªå…ˆå»¶ã°ã—ã€ã©ã¡ã‚‰ã‚‚ã‚µã‚¤ãƒ³ã«æ°—ã¥ã„ãŸã‚‰ä¸€åº¦ç«‹ã¡æ­¢ã¾ã‚‹"
      ].forEach(t=>addLi(risks,t));

      [
        "æ„æ€æ±ºå®šã®å‰ã«ã€ç›®çš„ãƒ»åˆ¶ç´„ãƒ»è©•ä¾¡è»¸ã€ã‚’1åˆ†ã§è¨€èªåŒ–ã™ã‚‹",
        "ä¼šè­°ã¯ã€æ±ºã‚ã‚‹ä¼šè­°ï¼è­°è«–ã™ã‚‹ä¼šè­°ã€ã®ã©ã¡ã‚‰ã‹ã‚’å…ˆã«å®£è¨€"
      ].forEach(t=>addLi(plays,t));

      [
        "è‡ªåˆ†ã®ä¸Šä½2è»¸ã‚’å®£è¨€ï¼šä¾‹ï¼‰ã€ç§ã¯æ¨é€²Ã—åˆ†æã€‚åˆå‹•ã¯ç§ã€ç²¾æŸ»ã¯Bã•ã‚“ã«ä»»ã›ãŸã„ã€",
        "ç›¸æ‰‹ã®ã‚¿ã‚¤ãƒ—ã«åˆã‚ã›ã€æƒ…å ±é‡ãƒ»ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒ»æ›–æ˜§ã•ã€ã®é…åˆã‚’å¤‰ãˆã‚‹"
      ].forEach(t=>addLi(collab,t));

      [
        "çµè«–â†’ç†ç”±â†’é¸æŠè‚¢â†’æ¬¡ã®ä¸€æ‰‹ ã®é †ã§ç°¡æ½”ã«",
        "â€œå•ã„ç›´ã—â€ã‚’å…¥ã‚Œã¦åˆæ„ã®ã‚ºãƒ¬ã‚’æ—©æœŸã«æ½°ã™"
      ].forEach(t=>addLi(comm,t));

      // ä»Šæ—¥/æ¥é€±
      document.getElementById("today").textContent =
        "ğŸŒŸ ä»Šæ—¥ã®ã²ã¨ã“ã¨ï¼šã€å®Œç’§ã‚ˆã‚Šå‰é€²ã€‚ã ãŒã€1è¡Œã§â€œä½•ã‚’ä»¥ã¦æˆåŠŸã¨ã™ã‚‹ã‹â€ã‚’æ›¸ã„ã¦ã‹ã‚‰å‹•ãã€‚ã€";
      document.getElementById("week").textContent =
        "ğŸ“… æ¥é€±ã‚„ã‚‹1ã¤ï¼šæ¯æ—¥ã®æœ€åˆã®æ„æ€æ±ºå®šã‚’â€œã‚¿ã‚¤ãƒ ãƒœãƒƒã‚¯ã‚¹10åˆ†â€ã§çµ‚ãˆã‚‹ç·´ç¿’ã‚’5å›ã€‚";

      // ã¾ã¨ã‚ã‚³ãƒ”ãƒ¼ã‚„ã‚·ã‚§ã‚¢ç”¨ã®è¦ç´„ã‚’ä½œã‚‹
      window.__summary = buildSummary({
        title, lead, orderCode, totals, topKey, secondKey,
        bullets, strengths: listTexts(strengths), risks: listTexts(risks), plays: listTexts(plays)
      });
    }

    function addLi(ul, text){ const li=document.createElement("li"); li.textContent=text; ul.appendChild(li); }
    function listTexts(ul){ return Array.from(ul.querySelectorAll("li")).map(li=>li.textContent); }

    function buildSummary({title, lead, orderCode, totals, topKey, secondKey, bullets, strengths, risks, plays}){
      return [
        `ã€æ„æ€æ±ºå®šã‚¿ã‚¤ãƒ—ã€‘${TYPE_META[topKey].short}Ã—${TYPE_META[secondKey].short}ï¼ˆ${title}ï¼‰`,
        `ãƒ»æ¦‚è¦ï¼š${lead}`,
        `ãƒ»é †ä½ã‚³ãƒ¼ãƒ‰ï¼š${orderCode}`,
        `ãƒ»ã‚¹ã‚³ã‚¢ï¼šA${totals.A}/B${totals.B}/C${totals.C}/D${totals.D}`,
        `ãƒ»è¦ç‚¹ï¼š${bullets.join(" / ")}`,
        `ãƒ»å¼·ã¿ï¼š${strengths.slice(0,3).join(" / ")}`,
        `ãƒ»æ³¨æ„ï¼š${risks.slice(0,2).join(" / ")}`,
        `ãƒ»æ¬¡ã®ä¸€æ‰‹ï¼š${plays[0]}`
      ].join("\n");
    }

    function copySummary(){
      if (!window.__summary) return;
      navigator.clipboard.writeText(window.__summary).then(()=>{
        toast("è¦ç´„ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
      });
    }

    function shareX(){
      if (!window.__summary) return;
      const text = encodeURIComponent(window.__summary + "\n#æ„æ€æ±ºå®šã‚¿ã‚¤ãƒ—è¨ºæ–­");
      const url = "https://twitter.com/intent/tweet?text=" + text;
      window.open(url, "_blank");
    }

    function toast(msg){
      const t = document.createElement("div");
      t.textContent = msg;
      t.className = "fixed bottom-5 left-1/2 -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded-lg shadow-lg text-sm";
      document.body.appendChild(t);
      setTimeout(()=>{ t.remove(); }, 1600);
    }
  </script>
</body>
</html>
