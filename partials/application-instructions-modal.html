<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>申込指示登録（名称入力あり）</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* 共通スタイル定義 */
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            vertical-align: middle;
        }
        .icon-sm { font-size: 1.125rem !important; } /* 18px */
        .icon-md { font-size: 1.25rem !important; }  /* 20px */

        /* カスタムスクロールバー */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #94a3b8;
        }

        /* アニメーション定義 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-900 antialiased min-h-dvh flex flex-col">
    
    <header class="sticky top-0 z-10 bg-white/95 backdrop-blur-sm border-b border-gray-100 px-6 py-4">
        <div class="flex items-center gap-2 mb-1">
            <span class="material-symbols-outlined text-blue-600">fact_check</span>
            <h1 class="text-lg font-bold text-gray-800 tracking-tight">申込指示登録</h1>
        </div>
        <p class="text-xs text-gray-500 ml-8">対象に応じた申込指示パターンを登録してください。</p>
    </header>

    <main class="flex-1 px-6 py-6 pb-40">
        <div id="instructions-container" class="space-y-6"></div>

        <div class="mt-8">
            <button onclick="addInstruction()" 
                class="group w-full py-5 rounded-xl border-2 border-dashed border-gray-300 bg-gray-50/50 text-gray-500 hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50/50 transition-all duration-200 flex items-center justify-center gap-2 font-bold text-sm">
                <span class="material-symbols-outlined group-hover:scale-110 transition-transform">add_circle</span>
                新しい指示パターンを追加
            </button>
        </div>
    </main>

    <div class="fixed bottom-0 inset-x-0 z-50 bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
        <div class="mx-auto px-6 py-4 flex items-center justify-between">
            <div class="text-xs text-gray-500 font-medium ml-1">
                登録数: <span id="total-count" class="font-bold text-gray-800 text-sm ml-1">0</span> 件
            </div>
            <div class="flex items-center gap-3">
                <button class="px-5 py-2.5 rounded-lg border border-gray-300 bg-white text-sm font-bold text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors">
                    キャンセル
                </button>
                <button class="px-6 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-bold hover:bg-blue-700 shadow-sm hover:shadow active:scale-[0.98] transition-all">
                    登録する
                </button>
            </div>
        </div>
    </div>

    <template id="instruction-template">
        <section class="instruction-card animate-fadeIn rounded-xl bg-white border border-gray-200 shadow-sm overflow-hidden transition-all hover:shadow-md hover:border-blue-200">
            <div class="bg-gray-50/50 px-5 py-3 border-b border-gray-100 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <span class="bg-blue-50 text-blue-700 border border-blue-100 text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wider">
                        Pattern <span class="index-badge text-blue-800 ml-0.5">1</span>
                    </span>
                    <span class="text-xs text-gray-400 font-medium">設定内容</span>
                </div>
                <button type="button" class="delete-btn size-8 flex items-center justify-center rounded-full text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors" title="削除">
                    <span class="material-symbols-outlined icon-md">delete</span>
                </button>
            </div>

            <div class="p-5 space-y-6">
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1.5">
                        指示パターン名称 <span class="text-red-500 ml-0.5">*</span>
                    </label>
                    <input type="text" 
                        class="block w-full rounded-lg border border-gray-300 px-4 py-2.5 text-sm font-bold text-gray-800 placeholder:text-gray-300 placeholder:font-normal focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50/50 hover:bg-white transition-all" 
                        placeholder="例：新卒入社者向け、関東エリア配属者用 など">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 bg-slate-50 p-5 rounded-xl border border-slate-100">
                    
                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">[101]教材配送先</label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>受講生宛</option>
                                <option>企業担当者宛</option>
                                <option>各社担当者宛</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [106]レポート提出
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>受講生→団体</option>
                                <option>企業担当者→団体</option>
                                <option>各社担当→団体</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [107]レポート返却
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>団体→受講生</option>
                                <option>団体→企業担当者</option>
                                <option>団体→各社担当</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [201]請求区分
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>会社請求</option>
                                <option>受講生請求</option>
                                <option>会社＆受講生請求</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [202]請求先
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>企業担当者宛</option>
                                <option>各社担当者宛</option>
                                <option>受講生宛</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [203]請求送付先
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>企業担当者宛</option>
                                <option>各社担当者宛</option>
                                <option>受講生宛</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [301,304]成績報告先
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>企業担当者宛</option>
                                <option>各社担当者宛</option>
                                <option>不要</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            [404]修了判定
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>各団体基準</option>
                                <option>基準指定</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-sm text-gray-500 uppercase tracking-wider">
                            再受講可否
                        </label>
                        <div class="relative">
                            <select class="h-10 block w-full rounded-md border border-gray-300 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white hover:border-gray-400 transition-colors cursor-pointer appearance-none">
                                <option>可</option>
                                <option>不可</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
                            </div>
                        </div>
                    </div>

                </div>

                <div>
                    <div class="flex justify-between items-end mb-1.5">
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">その他特記事項</label>
                        <div class="text-[10px] text-gray-400 font-mono">
                            <span class="char-count font-bold text-gray-600">0</span> / 500
                        </div>
                    </div>
                    <textarea rows="2" maxlength="500"
                        class="body-input block w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50/50 hover:bg-white transition-all resize-none"
                        placeholder="備考があれば記載してください"></textarea>
                </div>
            </div>
        </section>
    </template>

    <script>
        const container = document.getElementById('instructions-container');
        const template = document.getElementById('instruction-template');
        const totalCountEl = document.getElementById('total-count');

        function addInstruction() {
            const clone = template.content.cloneNode(true);
            const card = clone.querySelector('.instruction-card');
            
            // 削除
            card.querySelector('.delete-btn').addEventListener('click', () => {
                // アニメーション付き削除などは本来CSS遷移が必要ですが、
                // ここではシンプルに確認ダイアログ後に削除します
                if(confirm('この指示パターンを削除しますか？')) {
                    card.remove();
                    updateIndexes();
                }
            });

            // 文字数カウント & 自動高さ調整
            const textarea = card.querySelector('.body-input');
            const countSpan = card.querySelector('.char-count');
            
            textarea.addEventListener('input', () => {
                countSpan.textContent = textarea.value.length;
                textarea.style.height = 'auto';
                textarea.style.height = Math.min(textarea.scrollHeight, 300) + 'px';
            });

            container.appendChild(card);
            updateIndexes();
            
            // スクロールとフォーカス
            setTimeout(() => {
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                card.querySelector('input[type="text"]').focus();
            }, 100);
        }

        function updateIndexes() {
            const cards = container.querySelectorAll('.instruction-card');
            cards.forEach((card, index) => {
                const badge = card.querySelector('.index-badge');
                if(badge) badge.textContent = index + 1;
            });
            totalCountEl.textContent = cards.length;
        }

        window.addEventListener('DOMContentLoaded', () => {
            addInstruction();
        });
    </script>
  </body>
</html>