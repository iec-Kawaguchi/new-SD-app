<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<title>サイトユーザー登録</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script src="https://cdn.tailwindcss.com"></script>
		<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
		<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="./css/base-style.css">

		<style>
			/* カスタムスクロールバー */
			::-webkit-scrollbar { width: 6px; height: 6px; }
			::-webkit-scrollbar-track { background: transparent; }
			::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }
			::-webkit-scrollbar-thumb:hover { background-color: #94a3b8; }
		</style>
	</head>
	<body class="bg-gray-50 text-gray-900 antialiased">
		<div class="min-h-dvh flex flex-col">
			<header class="sticky top-0 z-20 bg-white/95 backdrop-blur-sm border-b border-gray-100 px-6 py-4">
				<div class="flex items-center gap-2 mb-1">
					<span class="material-symbols-outlined text-blue-600">group_add</span>
					<h1 class="text-lg font-bold text-gray-800 tracking-tight">サイトユーザー登録</h1>
				</div>
				<p class="text-xs text-gray-500 ml-8">募集サイトのログインユーザーを登録し、適用する申込指示パターンを紐付けます。</p>
			</header>
			<main class="flex-1 px-6 py-6 space-y-8 pb-32">
				<section class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
					<div class="bg-gray-50/50 px-5 py-3 border-b border-gray-100 flex items-center justify-between">
						<h2 class="text-sm font-bold text-gray-700 flex items-center gap-2">
						<span class="material-symbols-outlined icon-md text-gray-400">person_add</span>
						新規ユーザーを追加
						</h2>
					</div>
					
					<div class="p-6">
						<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-12 gap-x-4 gap-y-6 items-end">
							<div class="lg:col-span-3">
								<label for="name" class="block text-sm font-bold text-gray-700 mb-1.5">名前</label>
								<input id="name" type="text" class="block w-full rounded-md border border-gray-300 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50/50 transition-shadow hover:bg-white placeholder-gray-400" placeholder="例）営業部 共有アカウント" />
							</div>

							<div class="lg:col-span-3">
							<label for="uid" class="block text-sm font-bold text-gray-700 mb-1.5">ログインID</label>
							<div class="relative flex items-center">
								<input id="uid" type="text" class="block w-full rounded-md border border-gray-300 pl-3 pr-10 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50/50 transition-shadow hover:bg-white font-mono placeholder-gray-400" placeholder="user_01" />
								<button id="gen-id" type="button" class="absolute right-1 p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors" title="IDを自動生成">
									<span class="material-symbols-outlined icon-sm">auto_fix</span>
								</button>
							</div>
							</div>

							<div class="lg:col-span-3">
							<label for="pwd" class="block text-sm font-bold text-gray-700 mb-1.5">パスワード</label>
							<div class="relative flex items-center">
								<input id="pwd" type="password" class="block w-full rounded-md border border-gray-300 pl-3 pr-10 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50/50 transition-shadow hover:bg-white font-mono placeholder-gray-400" placeholder="••••••••" />
								<button id="toggle-pwd" type="button" class="absolute right-1 p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors" title="表示/非表示">
									<span class="material-symbols-outlined icon-sm">visibility</span>
								</button>
							</div>
							</div>

							<div class="lg:col-span-3">
							<label for="instruction-select" class="block text-sm font-bold text-gray-700 mb-1.5">適用パターン</label>
							<div class="relative">
								<select id="instruction-select" class="block w-full rounded-md border border-gray-300 pl-3 pr-8 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50/50 transition-shadow hover:bg-white appearance-none cursor-pointer text-gray-700">
									<option value="pat1">パターンA：営業部用</option>
									<option value="pat2">パターンB：開発部用</option>
								</select>
								<div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
									<span class="material-symbols-outlined text-gray-400 icon-sm">expand_more</span>
								</div>
							</div>
							</div>

							<div class="lg:col-span-12 flex justify-end mt-2">
								<button id="add" class="h-10 w-full md:w-auto px-6 rounded-lg bg-blue-600 text-white text-sm font-bold hover:bg-blue-700 hover:shadow active:scale-[0.98] transition-all flex items-center justify-center gap-2">
									<span class="material-symbols-outlined icon-sm">add</span>
									リストに追加
								</button>
							</div>

						</div>
					</div>
				</section>
				<section>
					<div class="flex items-center justify-between mb-3 px-1">
					<h2 class="text-sm font-bold text-gray-500 uppercase tracking-wide flex items-center gap-2">
						登録済みユーザー
						<span id="count-badge" class="bg-gray-200 text-gray-600 text-[10px] px-1.5 py-0.5 rounded-full hidden">0</span>
					</h2>
					</div>

					<div id="list" class="space-y-3"></div>

					<div id="empty" class="rounded-xl border-2 border-dashed border-gray-200 bg-gray-50 py-12 flex flex-col items-center justify-center text-center hidden">
						<div class="flex bg-white p-3 rounded-full shadow-sm mb-3">
							<span class="material-symbols-outlined text-gray-300 text-3xl">group_off</span>
						</div>
						<p class="text-gray-600 font-medium text-sm">まだ登録がありません</p>
						<p class="text-gray-400 text-xs mt-1">上のフォームからユーザーを追加してください。</p>
					</div>
				</section>
			</main>

			<div class="fixed bottom-0 inset-x-0 z-50 bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
				<div class="mx-auto px-6 py-4 flex items-center justify-end gap-3">
					<button class="px-5 py-2.5 rounded-lg border border-gray-300 bg-white text-sm font-bold text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors">
						キャンセル
					</button>
					<button class="px-6 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-bold hover:bg-blue-700 shadow-sm hover:shadow active:scale-[0.98] transition-all flex items-center gap-2">
						<span>登録する</span>
					</button>
				</div>
			</div>
		</div>

		<template id="row-tpl">
			<div class="group relative flex flex-col sm:flex-row sm:items-center gap-4 rounded-xl bg-white border border-gray-200 shadow-sm px-5 py-4 hover:shadow-md hover:border-blue-200 transition-all duration-200">
			<div class="absolute left-0 top-3 bottom-3 w-1 bg-blue-500 rounded-r opacity-0 group-hover:opacity-100 transition-opacity"></div>

			<div class="flex items-center gap-4 flex-1 min-w-0">
				<div class="shrink-0">
				<span class="avatar inline-grid place-items-center size-10 rounded-full bg-blue-50 text-blue-600 font-bold text-sm border border-blue-100 shadow-sm">U</span>
				</div>
				<div class="min-w-0 flex-1">
				<div class="flex flex-wrap items-center gap-2">
					<p class="name text-sm font-bold text-gray-800 truncate group-hover:text-blue-700 transition-colors">ユーザー名</p>
					<span class="instruction-badge hidden text-[10px] px-2 py-0.5 rounded bg-indigo-50 text-indigo-700 border border-indigo-100 font-medium truncate max-w-[120px]">
						パターン名
					</span>
				</div>
				
				<div class="mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-gray-500 font-mono">
					<div class="flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded border border-gray-100">
						<span class="material-symbols-outlined text-[14px] text-gray-400">badge</span>
						<span class="id">user_id</span>
					</div>
					<div class="flex items-center gap-1">
						<span class="material-symbols-outlined text-[14px] text-gray-400">key</span>
						<span class="pwd-display">••••••</span>
						<button class="toggle-row-pwd text-gray-400 hover:text-blue-600 transition-colors ml-1" title="パスワードを表示">
							<span class="material-symbols-outlined icon-sm">visibility</span>
						</button>
					</div>
				</div>
				</div>
			</div>

			<div class="flex items-center justify-end gap-2 mt-2 sm:mt-0 w-full sm:w-auto border-t sm:border-t-0 border-gray-100 pt-2 sm:pt-0">
				<button class="remove flex items-center justify-center size-8 rounded-full text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors" title="削除">
				<span class="material-symbols-outlined icon-md">delete</span>
				</button>
			</div>
			</div>
		</template>

		<script>
			// --- UI Logic (Mock) ---
			
			// 1. Password Visibility Toggle (Main Form)
			const pwdInput = document.getElementById('pwd');
			const toggleBtn = document.getElementById('toggle-pwd');
			toggleBtn.addEventListener('click', () => {
			const isPassword = pwdInput.type === 'password';
			pwdInput.type = isPassword ? 'text' : 'password';
			toggleBtn.querySelector('span').textContent = isPassword ? 'visibility_off' : 'visibility';
			});

			// 2. ID Auto Generation (Mock)
			const idInput = document.getElementById('uid');
			const genBtn = document.getElementById('gen-id');
			genBtn.addEventListener('click', () => {
			const random = Math.random().toString(36).substring(2, 8);
			idInput.value = `user_${random}`;
			});

			// 3. Add User & List Rendering
			const addBtn = document.getElementById('add');
			const nameInput = document.getElementById('name');
			const instructionSelect = document.getElementById('instruction-select');
			const listContainer = document.getElementById('list');
			const emptyState = document.getElementById('empty');
			const countBadge = document.getElementById('count-badge');
			const template = document.getElementById('row-tpl');

			const updateListState = () => {
			const hasItems = listContainer.children.length > 0;
			emptyState.classList.toggle('hidden', hasItems);
			countBadge.textContent = listContainer.children.length;
			countBadge.classList.toggle('hidden', !hasItems);
			};

			addBtn.addEventListener('click', () => {
			const name = nameInput.value.trim();
			const id = idInput.value.trim();
			const pwd = pwdInput.value.trim();
			const patternVal = instructionSelect.value;
			const patternText = instructionSelect.options[instructionSelect.selectedIndex].text;

			if (!name || !id || !pwd) {
				alert('名前、ID、パスワードは必須です');
				return;
			}

			// Clone Template
			const clone = template.content.cloneNode(true);
			const row = clone.querySelector('div');
			
			// Set Data
			row.querySelector('.name').textContent = name;
			row.querySelector('.avatar').textContent = name.charAt(0);
			row.querySelector('.id').textContent = id;
			
			// Pattern Badge
			const badge = row.querySelector('.instruction-badge');
			if (patternVal) {
				badge.textContent = patternText;
				badge.classList.remove('hidden');
			}

			// Row Password Toggle
			const rowPwdDisplay = row.querySelector('.pwd-display');
			const rowToggleBtn = row.querySelector('.toggle-row-pwd');
			let isRowPwdVisible = false;
			rowToggleBtn.addEventListener('click', () => {
				isRowPwdVisible = !isRowPwdVisible;
				rowPwdDisplay.textContent = isRowPwdVisible ? pwd : '••••••';
				rowToggleBtn.querySelector('span').textContent = isRowPwdVisible ? 'visibility_off' : 'visibility';
				rowToggleBtn.classList.toggle('text-blue-600', isRowPwdVisible);
			});

			// Remove Action
			row.querySelector('.remove').addEventListener('click', () => {
				if(confirm('削除しますか？')) {
					row.remove();
					updateListState();
				}
			});

			listContainer.appendChild(row);
			
			// Reset Form
			nameInput.value = '';
			idInput.value = '';
			pwdInput.value = '';
			instructionSelect.value = '';
			updateListState();
			});

			// Initial State
			updateListState();
			emptyState.classList.remove('hidden'); // Initially show empty

		</script>
	</body>
</html>